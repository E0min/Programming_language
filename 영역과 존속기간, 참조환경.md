# 영역과 존속기간, 참조환경
---
## 1. 영역과 존속 기간
> 변수의 영역과 존속기간은 관련되어 있는 것 같아 보인다. 그러나 영역은 공간적이고, 존속기간은 시간적인 범위를 가진다.

예시 1
* 함수에서 `static`을 이용하여 선언된 변수는 정적(실행 시간 전에 변수의 영역이 정해짐) 이며 지역적(블럭)이다. 그러나 존속기간은 함수가 속한 프로그램 전체의 실행 시간이다.
  
  <br>

예시 2
``` js
void printheader(){
    ...
}
void compute(){
    int sum;
    ...
    printheader();
}
```
 위와같은 경우 변수 sum의 영역은 compute()함수 내부에 완전히 포함된다. `compute()`함수가 `printheader()`함수를 호출한다해도 `sum`의 영역은 확장되는 것이 아니다. 하지만 존속시간은 `printheader()`가 실행되는 동안의 시간에 걸쳐서 확장된다.

### 영역과 존속기간 정리
영역: 참조가능성
* 가시성, 은폐성
* 정적, 동적
* 지역(블록), 전역

존속기간: 시간적
* __할당과 회수시간__
* 정적, 동적


## 2. 참조환경
> 어떤 문장의 참조환경은 그 문장에서 가시적인 모든 이름의 집합이다. 

### 정적 영역 언어
정적 영역 언어에서, 한 문장의 참조환경은 그 지역에 속한 변수들과, 그 조상영역에 있는 __가시적인__(동일 변수 이름으로 은폐가능성이 있어서 가시적인 이라는 표현이 붙었다.) 변수들이다.  

<br>

__예시__
```python
g = 3 # 전역변수
def sub1():
    a = 5
    b = 7
    .. # 지점 1
    def sub2():
        global g
        c = 9
        ... # 지점 2
        def sub3():
            nonlocal c 
            # global은 지역변수에서 전역변수를 배정할 때 사용한다.
            # nonlocal은 하위 지역변수에서 하위 지역변수의 값을 배정할 때 사용한다. 
            g = 11
            #  지점 3
```
* 지점 1의 참조 환경: `a`, `b`, 전역변수`g`
* 지점 2의 참조 환경: `sub2()의 지역변수 c`, 참조와 배정 둘 다 가능한 전역변수 `g` 
* 지점 3의 참조 환경: `nonlocal c(sub2의 변수)`, `지역변수 g`
* 파이썬의 변수들은 __정적 영역__ 이고, 기억 공간 바인딩과 존속기간(할당과 회수)의 개념으로는 __스택 동적__ 영역이다.

<br>

### 동적 영역 언어
동적 영역 언어에서, 한 문장의 참조환경은 그 지역 영역에 선언된 변수들과 현재 활성화되어 있는 모든 다른 부프로그램에서 선언된 변수들로 구성된다. 또한, 활성화된 부프로그램에 속한 어떤 변수들은 참조환경으로부터 은폐될 수 있다.

```c
void sub1(){
    int a, b;
    ...    // 지점 1
}
void sub2(){
    int b, c;
    ...    // 지점 2
    sub1();
}
void main(){
    int c, d;
    ...    // 지점 3
    sub2();
}
```
* 지점 1의 참조 환경: `sub1()의 a와 b`, `sub2(`)의 `c` ; `main()의 c`와 `sub2()의 b`는 은폐된다.
* 지점 2의 참조 환경: `sub2()의 b와c`, `main()의 d` ; `main()의 c`는 은폐된다.
* 지점 3의 참조 환경: `main()의 c와 d`